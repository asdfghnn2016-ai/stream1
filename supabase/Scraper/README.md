# โฝ ุณูุฑุงุจุฑ Kora โ ูุชุงุฆุฌ ุงููุจุงุฑูุงุช ุงููุจุงุดุฑุฉ

ุณูุฑุงุจุฑ Python ูุฌูุจ ูุชุงุฆุฌ ุงููุจุงุฑูุงุช ุงููุจุงุดุฑุฉ ูู **Yallakora.com** ููุญุฏูุซ ูุงุนุฏุฉ ุจูุงูุงุช **Supabase** ุชููุงุฆูุงู.

---

## ๐ ุงููุญุชููุงุช

- [ููู ูุดุชุบู](#-ููู-ูุดุชุบู)
- [ุงููููุงุช](#-ุงููููุงุช)
- [ุงูุชุดุบูู ุงููุญูู](#-ุงูุชุดุบูู-ุงููุญูู)
- [ุฑุจุท ุงููุดุฑูุน ุจุจุนุถู](#-ุฑุจุท-ุงููุดุฑูุน-ุจุจุนุถู)
- [GitHub Actions](#-github-actions)
- [ุงูุฃุณุฆูุฉ ุงูุดุงุฆุนุฉ](#-ุงูุฃุณุฆูุฉ-ุงูุดุงุฆุนุฉ)

---

## ๐ ููู ูุดุชุบู

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    ุงูุฏูุฑุฉ ุงููุงููุฉ                         โ
โ                                                         โ
โ  โฐ GitHub Actions (ูู 5 ุฏูุงุฆู)                          โ
โ       โ                                                  โ
โ       โผ                                                  โ
โ  ๐ scraper.py ูุจุฏุฃ                                      โ
โ       โ                                                  โ
โ       โโโโบ ๐ ููุชุญ Yallakora.com (Playwright)            โ
โ       โโโโบ ๐ ูุฌูุจ ุงููุจุงุฑูุงุช (ุงููุชุงุฆุฌุ ุงูุฏูุงุฆูุ ุงูุญุงูุงุช) โ
โ       โโโโบ ๐ด ูุนุทู ุฃููููุฉ ูููุจุงุฑูุงุช ุงููุจุงุดุฑุฉ              โ
โ       โโโโบ ๐พ ูุญุฏูุซ Supabase (Upsert)                     โ
โ       โโโโบ ๐ค ููุชุธุฑ 30 ุซุงููุฉ                              โ
โ       โโโโบ ๐ ููุฑุฑ ููุฏุฉ 5 ุฏูุงุฆู                          โ
โ                                                         โ
โ  ๐ฑ ุชุทุจูู Flutter ูุณุชูู ุงูุชุญุฏูุซุงุช ุนุจุฑ Realtime           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ ุงููููุงุช

| ุงูููู | ุงููุตู |
|-------|-------|
| `scraper.py` | ุงูุณูุฑุงุจุฑ ุงูุฑุฆูุณู โ ุญููุฉ 5 ุฏูุงุฆู + Playwright |
| `database.py` | ุทุจูุฉ ุงูู DB โ SQLAlchemy + Upsert |
| `requirements.txt` | ุงูููุชุจุงุช ุงููุทููุจุฉ |
| `.env.example` | ูููุฐุฌ ูุชุบูุฑุงุช ุงูุจูุฆุฉ |
| `../../.github/workflows/scrape.yml` | ุฅุนุฏุงุฏุงุช GitHub Actions |

---

## ๐ ุงูุชุดุบูู ุงููุญูู

### 1. ุซุจูุช Python

ุญููู Python 3.12+ ูู [python.org](https://python.org) ูุชุฃูุฏ ุฅู `pip` ุดุบูุงู.

### 2. ุซุจูุช ุงูููุชุจุงุช

```bash
cd supabase/Scraper
pip install -r requirements.txt
playwright install chromium
```

### 3. ุงุนุฏุงุฏุงุช ุงูุจูุฆุฉ

```bash
cp .env.example .env
```

ุงูุชุญ ููู `.env` ูุญุท ุฑุงุจุท ูุงุนุฏุฉ ุงูุจูุงูุงุช:

```
DATABASE_URL=postgresql://postgres.[ref]:[password]@aws-0-[region].pooler.supabase.com:6543/postgres
```

**๐ ููู ุชููุงู:**
1. ุงูุชุญ [supabase.com/dashboard](https://supabase.com/dashboard)
2. ุงุฎุชุงุฑ ูุดุฑูุนู
3. **Settings** โ **Database** โ **Connection string** โ **URI**
4. ุงูุณุฎ ุงูุฑุงุจุท ูุงุณุชุจุฏู `[YOUR-PASSWORD]` ุจูููุฉ ูุฑูุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช

### 4. ุดุบูู!

```bash
# ุชุดุบูู ูุฑุฉ ูุงุญุฏุฉ (ููุงุฎุชุจุงุฑ)
python scraper.py --once

# ุชุดุบูู ุจุฏูู ุชุญุฏูุซ ุงูู DB (ููุดุงูุฏุฉ ุงูุจูุงูุงุช ููุท)
python scraper.py --dry-run

# ุชุดุบูู ุงูุญููุฉ ุงููุงููุฉ (5 ุฏูุงุฆู)
python scraper.py
```

---

## ๐ ุฑุจุท ุงููุดุฑูุน ุจุจุนุถู

### ุฎุฑูุทุฉ ุงูููููุงุช ุงููุงููุฉ

```
flutter_ui1/
โ
โโโ lib/                          โ ๐ฑ ุชุทุจูู Flutter
โ   โโโ main.dart                 โ ููุทุฉ ุงูุจุฏุงูุฉ (Supabase.initialize)
โ   โโโ services/
โ   โ   โโโ supabase_service.dart โ ูุฌูุจ ุงูุจูุงูุงุช ูู Supabase
โ   โโโ models/                   โ Match, Team, League...
โ   โโโ screens/                  โ ุงูุดุงุดุงุช (ุชุนุฑุถ ุงูุจูุงูุงุช)
โ
โโโ supabase/
โ   โโโ migrations/               โ ๐๏ธ ูููู ูุงุนุฏุฉ ุงูุจูุงูุงุช
โ   โ   โโโ 001_schema.sql        โ ุงูุฌุฏุงูู
โ   โ   โโโ 002_indexes.sql       โ ุงูููุงุฑุณ
โ   โ   โโโ 003_rls.sql           โ ุตูุงุญูุงุช ุงููุตูู
โ   โ   โโโ 004_realtime.sql      โ ุงูุจุซ ุงููุจุงุดุฑ
โ   โ   โโโ 005_seed.sql          โ ุจูุงูุงุช ุชุฌุฑูุจูุฉ
โ   โ
โ   โโโ functions/                โ โ๏ธ Edge Functions
โ   โ   โโโ get-league-details/   โ ุชูุงุตูู ุงูุฏูุฑู
โ   โ   โโโ get-match-details/    โ ุชูุงุตูู ุงููุจุงุฑุงุฉ
โ   โ   โโโ update-live-match/    โ ุชุญุฏูุซ ูุจุงุฑุงุฉ ูุจุงุดุฑุฉ
โ   โ
โ   โโโ Scraper/                  โ ๐ ุงูุณูุฑุงุจุฑ (ุฃูุช ููุง!)
โ   โ   โโโ scraper.py
โ   โ   โโโ database.py
โ   โ   โโโ requirements.txt
โ   โ   โโโ .env.example
โ   โ
โ   โโโ README.md                 โ ุฏููู ุงูุจุงู-ุฅูุฏ
โ
โโโ .github/workflows/
    โโโ scrape.yml                โ โฐ GitHub Actions
```

### ููู ูุชุฑุจุท ุจุจุนุถู

```
                    โโโโโโโโโโโโโโโโ
                    โ   Yallakora  โ
                    โ    .com      โ
                    โโโโโโโโฌโโโโโโโโ
                           โ Playwright ูุฌูุจ HTML
                           โผ
                    โโโโโโโโโโโโโโโโ
                    โ  scraper.py  โโโโ GitHub Actions (ูู 5 ุฏู)
                    โโโโโโโโฌโโโโโโโโ
                           โ SQLAlchemy Upsert
                           โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ              Supabase PostgreSQL              โ
โ                                              โ
โ  leagues โ teams โ matches โ match_events    โ
โ  (ุงูุฏูุฑูุงุช) (ุงููุฑู) (ุงููุจุงุฑูุงุช) (ุงูุฃุญุฏุงุซ)    โ
โ                                              โ
โ  โโโโ Realtime ููุนูู ุนูู: โโโโ               โ
โ  โข matches (ุชุญุฏูุซ ุงููุชุงุฆุฌ)                    โ
โ  โข match_events (ุฃูุฏุงูุ ุจุทุงูุงุช)              โ
โ  โข standings (ุงูุชุฑุชูุจ)                        โ
โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
               โ Supabase Realtime
               โผ
        โโโโโโโโโโโโโโโโ
        โ  Flutter App  โ
        โ  ๐ฑ ุดูู TV   โ
        โโโโโโโโโโโโโโโโ
```

### ุงูุฎุทูุงุช ุจุงูุชุฑุชูุจ

| # | ุงูุฎุทูุฉ | ุงููุตู |
|---|--------|-------|
| 1 | **SQL ูู Supabase** | ุดุบููุช ูููุงุช `001` ุฅูู `005` โ โ ุฎูุตุช |
| 2 | **ุงูุณูุฑุงุจุฑ** | `scraper.py` ูุฌูุจ ุงูุจูุงูุงุช ููุญุฏูุซ ุฌุฏูู `matches` |
| 3 | **Realtime** | Supabase ูุฑุณู ุงูุชุญุฏูุซุงุช ุชููุงุฆูุงู ููุชุทุจูู |
| 4 | **Flutter** | `supabase_service.dart` ูุณุชูู ุงูุจูุงูุงุช ููุนุฑุถูุง |

**ุงูุฌุฒุก ุงูุณุญุฑู:** ููุง ุงูุณูุฑุงุจุฑ ูุญุฏูุซ ูุชูุฌุฉ ูุจุงุฑุงุฉ ูู ุฌุฏูู `matches`ุ Supabase Realtime ูุฑุณู ุงูุชุญุฏูุซ **ููุฑุงู** ูุชุทุจูู Flutter โ ูุนูู ุงููุณุชุฎุฏู ูุดูู ุงููุชูุฌุฉ ุชุชุบูุฑ **ูุญุธูุงู**! โก

---

## โฐ GitHub Actions

### ุฅุนุฏุงุฏ ุงูู Secret

1. ุงูุชุญ ุตูุญุฉ ุงููุดุฑูุน ุนูู **GitHub**
2. **Settings** โ **Secrets and variables** โ **Actions**
3. ุงุถุบุท **New repository secret**
4. ุงูุงุณู: `DATABASE_URL`
5. ุงููููุฉ: ุฑุงุจุท ูุงุนุฏุฉ ุงูุจูุงูุงุช (ููุณ ุงููู ูู `.env`)

### ุงูุชุดุบูู

ุจุนุฏ ูุง ุชุถูู ุงูู Secret:
- ุงูุณูุฑุงุจุฑ ูุดุชุบู **ุชููุงุฆูุงู ูู 5 ุฏูุงุฆู** โฐ
- ุฃู ุดุบููู ูุฏููุงู ูู ุชุจููุจ **Actions** โ **Live Scores Scraper** โ **Run workflow**

### ูุฑุงูุจุฉ ุงููููุงุช

1. ุงูุชุญ ุชุจููุจ **Actions** ูู GitHub
2. ุงุถุบุท ุนูู ุขุฎุฑ ุชุดุบูู
3. ุดูู ุงููููุงุช โ ุงูููุฑูุถ ุชุดูู:

```
09:00:01 | INFO    | โฝ ุณูุฑุงุจุฑ Kora โ ุจุฏุงูุฉ ุงูุชุดุบูู
09:00:03 | INFO    | ๐ ุชุดุบูู ุงููุชุตูุญ...
09:00:08 | INFO    | ๐ฆ ููุฌุฏ 24 ุนูุตุฑ ูุจุงุฑุงุฉ ูู ุงูุตูุญุฉ
09:00:08 | INFO    | ๐ ุชู ุฌูุจ 24 ูุจุงุฑุงุฉ
09:00:08 | INFO    | ๐ด 3 ูุจุงุฑุงุฉ ูุจุงุดุฑุฉ!
09:00:08 | INFO    |   ๐ด ุงูุฃููู 2-1 ุงูุงุชุญุงุฏ (ุฏูุฑู ุฑูุดู)
09:00:09 | INFO    | ๐พ DB: 24 ุชุญุฏูุซ | 0 ุชุฎุทู
09:00:09 | INFO    | ๐ค ุงูุชุธุงุฑ 30s...
```

---

## โ ุงูุฃุณุฆูุฉ ุงูุดุงุฆุนุฉ

### ุงูุณูุฑุงุจุฑ ูุด ูุงูู ุงููุฑู ูู ุงูู DBุ
ุงููุฑู ูุงุฒู ุชููู ููุฌูุฏุฉ **ูุณุจูุงู** ูู ุฌุฏูู `teams`. ุงูุณูุฑุงุจุฑ ูุจุญุซ ุจุงูุงุณู ุงูุนุฑุจู. ูู ุงูุฃุณูุงุก ูุฎุชููุฉ ุจูู ุงููููุน ูุงูู DBุ ุถูู ุงูุฃุณูุงุก ุงูุจุฏููุฉ.

### ูููู ุฃุบููุฑ ุงููููุน ุงููุตุฏุฑุ
ุฃููุง! ุบููุฑ `YALLAKORA_URL` ูู `scraper.py` ู ุนุฏูู ุงูู CSS selectors ูู `extract_match_from_element()`.

### ุงูุณูุฑุงุจุฑ ุจุทูุกุ
- ุชุฃูุฏ ุฅู ุงูุงูุชุฑูุช ุณุฑูุน
- Playwright ูุญุชุงุฌ ูุญููู ุงูุตูุญุฉ ูุงููุฉ
- ุงูู `wait_for_timeout(3000)` ูููู ุชูููููุง ูู ุงููููุน ูุญููู ุจุณุฑุนุฉ

### GitHub Actions ูุฌุงููุ
ุฃููุง! GitHub ูุนุทูู **2000 ุฏูููุฉ ูุฌุงูุงู ุดูุฑูุงู** ูููุดุงุฑูุน ุงูุฎุงุตุฉุ ู **unlimited** ูููุดุงุฑูุน ุงูุนุงูุฉ.

### ููู ุฃููู ุงูุณูุฑุงุจุฑุ
- ูู GitHub: **Settings** โ **Actions** โ **General** โ ุนุทูู ุงูู Workflow
- ุฃู ุงุญุฐู ููู `.github/workflows/scrape.yml`
